You are working on a Flutter application that follows Clean Architecture with:

features/

data / presentation / domain

Cubit (flutter_bloc) for state management

Repositories

Firebase (Firestore + FCM)

Supabase for authentication

A centralized color system (AppColors)

Custom UI components (CustomAppBar, cards, buttons, etc.)

The app already has a Settings page with a Theme option.

ğŸ¯ TASK OBJECTIVE

Implement a fully functional Light / Dark Theme system that:

Affects the entire UI

Backgrounds

Text colors

Icons

Cards

AppBar

Buttons

Shadows

Dividers

Custom widgets

Uses Cubit for state management

Persists user preference

Can be toggled from the Settings page

Scales cleanly with the existing architecture

ğŸ§± ARCHITECTURE REQUIREMENTS

You MUST:

1ï¸âƒ£ Create a Theme Feature
lib/features/theme/
 â”œâ”€â”€ data/
 â”‚   â””â”€â”€ theme_repository.dart
 â”œâ”€â”€ presentation/
 â”‚   â”œâ”€â”€ cubit/theme_cubit.dart
 â”‚   â”œâ”€â”€ cubit/theme_state.dart
 â”‚   â””â”€â”€ pages/theme_settings_page.dart

2ï¸âƒ£ Use Cubit

ThemeCubit

States: light, dark

Expose:

void toggleTheme();
void setTheme(AppTheme theme);

3ï¸âƒ£ Persist Theme

Store theme preference using one of:

SharedPreferences (recommended)

Supabase user metadata

Firebase Firestore user document

Explain why you chose it.

ğŸ¨ UI & COLORS (VERY IMPORTANT)
You MUST refactor ALL colors:

Remove hardcoded colors (Colors.white, Color(0xff...))

Replace them with theme-aware colors

Example:

Theme.of(context).colorScheme.background
Theme.of(context).colorScheme.primary
Theme.of(context).textTheme.bodyMedium

Create:

lightTheme

darkTheme

Using:

ThemeData(
  brightness: Brightness.light / dark,
  colorScheme: ColorScheme.fromSeed(...)
)


Also:

Update AppColors to support both themes OR replace it cleanly

ğŸ”„ APP ENTRY POINT

Modify main.dart to:

Listen to ThemeCubit

Dynamically switch themes using:

BlocBuilder<ThemeCubit, ThemeState>


Example:

MaterialApp(
  theme: lightTheme,
  darkTheme: darkTheme,
  themeMode: state.isDark ? ThemeMode.dark : ThemeMode.light,
)

âš™ï¸ SETTINGS PAGE INTEGRATION

Add a Theme toggle in Settings

UI must match existing Settings style

Use:

Switch

Or radio buttons (Light / Dark / System)

When toggled:

Theme updates instantly

Preference is saved

ğŸ§ª EXTRA REQUIREMENTS (IMPORTANT)

Respect system theme if selected

No UI flicker on app restart

Clean, readable, production-ready code

Add comments explaining key decisions

Do NOT break existing pages

ğŸ“¦ FINAL OUTPUT EXPECTED

Full implementation code

Updated main.dart

Updated Settings page

ThemeCubit + Repository

Light & Dark Theme definitions

Explanation of architecture decisions